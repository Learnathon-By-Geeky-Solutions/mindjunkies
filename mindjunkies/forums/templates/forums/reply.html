{% load static %}

<div class="reply-container {% if depth > 0 %}{{ current_indent }} child-reply{% else %}mb-8{% endif %}">
  {% if depth > 0 %}
    <div class="thread-line"></div>
  {% endif %}
  
  <div class="reply-content">
    <!-- Comment Header -->
    <div class="flex items-center mb-{% if depth > 0 %}2{% else %}4{% endif %}">
      <div class="flex items-center">
        <div class="avatar placeholder mr-3 {% if depth > 0 %}w-8 h-8{% else %}w-10 h-10{% endif %}">
          <div class="ring ring-base-200 ring-offset-base-100 ring-offset-2 rounded-full">
            <img src="https://ui-avatars.com/api/?name={{reply.author}}&background=random" 
                alt="{{reply.author}}" 
                class="{% if depth > 0 %}w-6 h-6{% else %}w-8 h-8{% endif %} rounded-full">
          </div>
        </div>
        <div>
          <div class="flex items-center">
            <span class="font-medium mr-2 {% if depth > 0 %}text-sm{% endif %}">{{reply.author}}</span>
            <span class="badge badge-info badge-sm text-xs">Learner</span>
          </div>
          <div class="{% if depth > 0 %}text-xs{% else %}text-sm{% endif %} text-gray-500">{{reply.created_at}}</div>
        </div>
      </div>
    </div>
    
    <!-- Comment Content -->
    <div class="text-gray-800 mb-{% if depth > 0 %}2{% else %}4{% endif %} {% if depth > 0 %}text-sm{% endif %}">
      <p>{{reply.body}}</p>
    </div>
    
    <!-- Comment Actions -->
    <div class="flex items-center space-x-{% if depth > 0 %}3{% else %}4{% endif %} mb-4">
      <button class="reaction-btn btn btn-ghost btn-xs flex items-center text-gray-700 hover:text-blue-600 {% if depth > 0 %}text-xs{% endif %}">
        <svg xmlns="http://www.w3.org/2000/svg" class="{% if depth > 0 %}h-4 w-4{% else %}h-5 w-5{% endif %} mr-1" fill="none" viewBox="0 0 24 24" stroke="currentColor">
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M14 10h4.764a2 2 0 011.789 2.894l-3.5 7A2 2 0 0115.263 21h-4.017c-.163 0-.326-.02-.485-.06L7 20m7-10V5a2 2 0 00-2-2h-.095c-.5 0-.905.405-.905.905 0 .714-.211 1.412-.608 2.006L7 11v9m7-10h-2M7 20H5a2 2 0 01-2-2v-6a2 2 0 012-2h2.5" />
        </svg>
        Like
      </button>
     
      <a class="reaction-btn btn btn-ghost btn-xs flex cursor-pointer items-center text-gray-700 hover:text-blue-600 {% if depth > 0 %}text-xs{% endif %}" 
              hx-get="{% url 'reply_form'  reply.id %}" 
              hx-target="#reply-form-container-{{reply.id}}" 
              hx-swap="innerHTML"
              hx-trigger="click">
        <svg xmlns="http://www.w3.org/2000/svg" class="{% if depth > 0 %}h-4 w-4{% else %}h-5 w-5{% endif %} mr-1" fill="none" viewBox="0 0 24 24" stroke="currentColor">
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 12h.01M12 12h.01M16 12h.01M21 12c0 4.418-4.03 8-9 8a9.863 9.863 0 01-4.255-.949L3 20l1.395-3.72C3.512 15.042 3 13.574 3 12c0-4.418 4.03-8 9-8s9 3.582 9 8z" />
        </svg>
        Reply
      </a>
      
      {% if depth == 0 %}
      <div class="dropdown dropdown-end">
        <label tabindex="0" class="reaction-btn btn btn-ghost btn-xs flex items-center text-gray-700 hover:text-blue-600 cursor-pointer">
          <span>More</span>
          <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5 ml-1" fill="none" viewBox="0 0 24 24" stroke="currentColor">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 12h.01M12 12h.01M19 12h.01M6 12a1 1 0 11-2 0 1 1 0 012 0zm7 0a1 1 0 11-2 0 1 1 0 012 0zm7 0a1 1 0 11-2 0 1 1 0 012 0z" />
          </svg>
        </label>
        <ul tabindex="0" class="dropdown-content menu p-2 shadow bg-base-100 rounded-md w-52 z-10">
          <li><a>Report</a></li>
          <li><a>Copy link</a></li>
        </ul>
      </div>
      {% endif %}
    </div>
  </div>
  
  <!-- Reply Form Container -->
  <div id="reply-form-container-{{reply.id}}" class="mb-4"></div>
  
  <!-- Child Replies Container -->
  <div class="mb-{% if depth == 0 %}14{% else %}4{% endif %}">
    {% for child_reply in reply.replies.all %}
      {% include "forums/reply.html" with reply=child_reply depth=depth|add:1 %}
    {% endfor %}
  </div>
</div>

